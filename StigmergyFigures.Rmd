---
title: "StigmergyFigures"
author: "Lauren White"
date: "9/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries

```{r}
library(ggplot2)
```

## Load multiplot function

To help create multi-paneled figure

```{r}
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols), byrow=TRUE)
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}


```

## Load data
```{r}
merged_data<-read.csv("stig_summary.csv")

##Make some sub data sets by density and recovery rate
size50<-merged_data[which(merged_data$n.initial==50),]
size100<-merged_data[which(merged_data$n.initial==100),]
size150<-merged_data[which(merged_data$n.initial==150),]


sub_dT_r0.01<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.01),]
sub_dT_r0.05<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.05),]
sub_dT_r0.1<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.1),]

sub_n50_dT_r0.01<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.01 & merged_data$n.initial==50),]
sub_n50_dT_r0.05<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.05 & merged_data$n.initial==50),]
sub_n50_dT_r0.1<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.1 & merged_data$n.initial==50),]

sub_n100_dT_r0.01<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.01 & merged_data$n.initial==100),]
sub_n100_dT_r0.05<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.05 & merged_data$n.initial==100),]
sub_n100_dT_r0.1<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.1 & merged_data$n.initial==100),]

sub_n150_dT_r0.01<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.01 & merged_data$n.initial==150),]
sub_n150_dT_r0.05<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.05 & merged_data$n.initial==150),]
sub_n150_dT_r0.1<-merged_data[which(merged_data$dir_move==TRUE & merged_data$rec_rate==0.1 & merged_data$n.initial==150),]

```


## Figure 2
Plotting movement trajectories from `ToyModelStigmergy.R`
```{r}
source('~/StigmergyDisease/ToyModelStigmergy.R')
library(tidyr)

movedat<-t(movedat)
rownames(movedat)<-1:nrow(movedat)
movedat<-as.data.frame(movedat)
movedat$time<-1:nrow(movedat)

movedf<-gather(movedat, key="AnimalID", value= "Vec",colnames(movedat)[1:n.initial])
test2<-Rmatrix(movedf$Vec-1, lsize)
movedf$xloc<-test2$col
movedf$yloc<-test2$row
movedf$dist<-rep(0, times=nrow(movedf))

linear_dist<-function(x1,x2, y1, y2)
{
  sqrt((x1-x2)^2+(y1-y2)^2)
}

for(i in 1:(nrow(movedf)-1)){
  movedf$dist[i+1]<-linear_dist(movedf$xloc[i], movedf$xloc[i+1], movedf$yloc[i], movedf$yloc[i+1])
}
movedf$yloc[which(movedf$dist>1.5)]<-NA #for visibility remove steps that wrap around torus
colnames(movedf)[colnames(movedf)=="time"] <- "time_step"

## Fig. 2 static movement trajectories
 # m <- ggplot(movedf, aes(xloc, yloc, color=AnimalID, alpha=time_step*0.01))+
m <- ggplot(movedf, aes(xloc, yloc, color=AnimalID))+
  geom_path(show.legend=FALSE)+xlab(NULL)+ylab(NULL)+
  theme(legend.position = "none") 
tiff("Fig2.tiff", height =4 , width =3.9, units = "in", compression = "lzw", res = 600)
  m
dev.off()
```


## Figure 3
Random forest variable importance plots for: (A) outbreak success; (B) maximum prevalence; and (C) outbreak duration.

```{r}
#Load importance values (party package)
imp_logit<-read.csv("imp_logit.csv")
imp_logitprev<-read.csv("imp_prev.csv")
imp_logitdur<-read.csv("imp_dur.csv")

#Order according to increasing node purity
imp_logit<-imp_logit[order(imp_logit$MeanDecreaseAccuracy),]
imp_logitdur<-imp_logitdur[order(imp_logitdur$X.IncMSE),] 
imp_logitprev<-imp_logitprev[order(imp_logitprev$X.IncMSE),] 

#In ggplot
A<-ggplot(imp_logit, aes(x=reorder(X,MeanDecreaseAccuracy), y=MeanDecreaseAccuracy)) + 
  geom_bar(position=position_dodge(), stat="identity",
           colour="black", # Use black outlines,
           size=.3) +      # Thinner lines
  # geom_errorbar(aes(ymin=X.IncMSE-SD, ymax=X.IncMSE+SD),
  #               size=.3,    # Thinner lines
  #               width=.2,
  #               position=position_dodge(.9)) +
scale_x_discrete(element_blank(), labels = c("scent_decay" = expression(paste("Scent decay (", delta, ")")), "rec_rate"=expression(paste("Recovery rate (", gamma, ")")), "scent_load" =  expression(paste("Scent load (", eta[0], ")")),"n.initial" = "Host density (N)", "dir_move" = "Movement type (m)","pathogen_load" = expression(paste("Pathogen load (", kappa[0], ")")), "inf_decay"=expression(paste("Pathogen decay rate (", alpha, ")"))))+ 
  ylab("")+
  theme_bw()+
  ggtitle("(A) Outbreak Success") + #" Variable Importance for Epidemic \nSuccess") +
  theme(axis.text=element_text(size=10), plot.title = element_text(size = 12)) +
  theme(plot.margin=unit(c(0.1,0.2,0, 0), "cm"))+
  coord_flip()
# theme_bw(axis.text=element_text(size=14),    axis.title=element_text(size=14,face="bold"), plot.title = element_text(size = 40))
A
#imp_logitprev$SD<-rep(0.0000001, times=nrow(imp_logitprev))
B<-ggplot(imp_logitprev, aes(x=reorder(X,X.IncMSE), y=X.IncMSE)) + 
  geom_bar(position=position_dodge(), stat="identity",
           colour="black", # Use black outlines,
           size=.3) +      # Thinner lines
  # geom_errorbar(aes(ymin=X.IncMSE-SD, ymax=X.IncMSE+SD),
  #               size=.3,    # Thinner lines
  #               width=.2,
  #               position=position_dodge(.9)) +
  scale_x_discrete(element_blank(), labels = c("scent_decay" = expression(paste("Scent decay (", delta, ")")), "rec_rate"=expression(paste("Recovery rate (", gamma, ")")), "scent_load" =  expression(paste("Scent load (", eta[0], ")")),"n.initial" = "Host density (N)", "dir_move" = "Movement type (m)","pathogen_load" = expression(paste("Pathogen load (", kappa[0], ")")), "inf_decay"=expression(paste("Pathogen decay rate (", alpha, ")"))))+ 
  ylab("")+
  theme_bw()+
  ggtitle("(B) Maximum Prevalence") + #" Variable Importance for Maximum \nPrevalence|Success") +
  theme(axis.text=element_text(size=10), plot.title = element_text(size = 12)) +
  theme(plot.margin=unit(c(-0.25,0.2,0,0), "cm"))+
  coord_flip()
B
#imp_logitdur$SD<-rep(100, times=nrow(imp_logitdur))
C<-ggplot(imp_logitdur, aes(x=reorder(X,X.IncMSE), y=X.IncMSE)) + 
  geom_bar(position=position_dodge(), stat="identity",
           colour="black", # Use black outlines,
           size=.3) +      # Thinner lines
  # geom_errorbar(aes(ymin=X.IncMSE-SD, ymax=X.IncMSE+SD),
  #               size=.3,    # Thinner lines
  #               width=.2,
  #               position=position_dodge(.9)) +
  scale_x_discrete(element_blank(), labels = c("scent_decay" = expression(paste("Scent decay (", delta, ")")), "rec_rate"=expression(paste("Recovery rate (", gamma, ")")), "scent_load" =  expression(paste("Scent load (", eta[0], ")")),"n.initial" = "Host density (N)", "dir_move" = "Movement type (m)","pathogen_load" = expression(paste("Pathogen load (", kappa[0], ")")), "inf_decay"=expression(paste("Pathogen decay rate (", alpha, ")"))))+ 
  
  ylab("Mean Decrease in Accuracy") +
  theme_bw()+
  ggtitle("(C) Duration") + #" Variable Importance for Epidemic \nDuration|Success") +
  
  theme(axis.text=element_text(size=10), plot.title = element_text(size = 12)) +
  theme(plot.margin=unit(c(-0.25,0.2,0,0), "cm"))+
  coord_flip()
C
#setwd()
tiff("Fig3.tiff", height =12 , width =10, units = "cm", compression = "lzw", res = 600)
multiplot(A, B, C, cols=1)
dev.off()
```


## Figure 4
```{r}
library(doBy)
merged_data_stig<-size150[which(size150$dir_move==TRUE),]

merged_data_rand<-size150[which(size150$dir_move==FALSE),]

mean_prev_stig <- summaryBy(max_prevalence~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_stig, FUN=mean)

mean_dur_stig <- summaryBy(duration~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_stig, FUN=mean)

mean_prev_rand <- summaryBy(max_prevalence~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_rand, FUN=mean)

mean_dur_rand <- summaryBy(duration~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_rand, FUN=mean)



# Difference in mean prevalence -------------------------------------------

delta_mean_prev<-mean_prev_rand
delta_mean_prev$max_prevalence.mean.stig<-mean_prev_stig$max_prevalence.mean
delta_mean_prev$diff<-mean_prev_stig$max_prevalence.mean- mean_prev_rand$max_prevalence.mean 

gg<- ggplot(data=delta_mean_prev, aes(y=diff, x=as.factor(rec_rate)))
gg<-gg+ geom_boxplot()+ facet_grid( ~ inf_decay, scales= "free_x", labeller= labeller(
  dir_move = c("FALSE" = "Random", "TRUE"="Stigmergy"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")))
gg<- gg+ labs(x = expression(Recovery~rate~(gamma)), y = "Difference in mean maximum prevalence (stigmergy-random)") #,title="(A)")
#gg<- gg+ theme(axis.title.x = element_text(face="bold", size=10),title=element_text(face="bold", size=10))
gg<- gg + theme(axis.text = element_text(size=12))
gg<- gg + theme(axis.text.x =element_text(vjust= 0, angle=-90))
gg<- gg + theme(axis.title = element_text(vjust=0.5, size=10))
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8))
gg<- gg + theme(plot.title = element_text(size = 10))
gg<- gg + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
gg<- gg + ggtitle("(A)")
#gg<-gg + geom_text(data = means , aes(label = duration, y = duration + 0.08))
gg


delta_mean_dur<-mean_dur_rand
delta_mean_dur$duration.mean.stig<-mean_dur_stig$duration.mean
delta_mean_dur$diff<-mean_dur_stig$duration.mean- mean_dur_rand$duration.mean

hh<- ggplot(data=delta_mean_dur, aes(y=diff, x=as.factor(rec_rate)))
hh<-hh+ geom_boxplot()+ facet_grid( ~ inf_decay, scales= "free_x", labeller= labeller(
  dir_move = c("FALSE" = "Random", "TRUE"="Stigmergy"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")))
hh<- hh+ labs(x = expression(Recovery~rate~(gamma)), y = "Difference in mean duration (stigmergy-random)") #,title="(A)")
#hh<- hh+ theme(axis.title.x = element_text(face="bold", size=10),title=element_text(face="bold", size=10))
hh<- hh + theme(axis.text = element_text(size=12))
hh<- hh + theme(axis.text.x =element_text(vjust= 0, angle=-90))
hh<- hh + theme(axis.title = element_text(vjust=0.5, size=10))
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8))
hh<- hh + theme(plot.title = element_text(size = 10))
hh<- hh + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
hh<- hh + ggtitle("(B)")
#hh<-hh + geom_text(data = means , aes(label = duration, y = duration + 0.08))
hh

multiplot(gg, hh, cols=1)

tiff("Fig4.tiff", height =8.75 , width =6.34, units = "in", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```

## Figure S1
```{r}
merged_data_stig<-size100[which(merged_data$dir_move==TRUE),]
merged_data_rand<-size100[which(merged_data$dir_move==FALSE),]

mean_prev_stig <- summaryBy(max_prevalence~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_stig, FUN=mean)

mean_dur_stig <- summaryBy(duration~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_stig, FUN=mean)

mean_prev_rand <- summaryBy(max_prevalence~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_rand, FUN=mean)

mean_dur_rand <- summaryBy(duration~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_rand, FUN=mean)



# Difference in mean prevalence -------------------------------------------

delta_mean_prev<-mean_prev_rand
delta_mean_prev$max_prevalence.mean.stig<-mean_prev_stig$max_prevalence.mean
delta_mean_prev$diff<-mean_prev_stig$max_prevalence.mean- mean_prev_rand$max_prevalence.mean 

gg<- ggplot(data=delta_mean_prev, aes(y=diff, x=as.factor(rec_rate)))
gg<-gg+ geom_boxplot()+ facet_grid( ~ inf_decay, scales= "free_x", labeller= labeller(
  dir_move = c("FALSE" = "Random", "TRUE"="Stigmergy"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")))
gg<- gg+ labs(x = expression(Recovery~rate~(gamma)), y = "Difference in mean maximum prevalence (stigmergy-random)") #,title="(A)")
#gg<- gg+ theme(axis.title.x = element_text(face="bold", size=10),title=element_text(face="bold", size=10))
gg<- gg + theme(axis.text = element_text(size=12))
gg<- gg + theme(axis.text.x =element_text(vjust= 0, angle=-90))
gg<- gg + theme(axis.title = element_text(vjust=0.5, size=10))
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8))
gg<- gg + theme(plot.title = element_text(size = 10))
gg<- gg + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
gg<- gg + ggtitle("(A)")
#gg<-gg + geom_text(data = means , aes(label = duration, y = duration + 0.08))
gg


delta_mean_dur<-mean_dur_rand
delta_mean_dur$duration.mean.stig<-mean_dur_stig$duration.mean
delta_mean_dur$diff<-mean_dur_stig$duration.mean- mean_dur_rand$duration.mean

hh<- ggplot(data=delta_mean_dur, aes(y=diff, x=as.factor(rec_rate)))
hh<-hh+ geom_boxplot()+ facet_grid( ~ inf_decay, scales= "free_x", labeller= labeller(
  dir_move = c("FALSE" = "Random", "TRUE"="Stigmergy"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")))
hh<- hh+ labs(x = expression(Recovery~rate~(gamma)), y = "Difference in mean duration (stigmergy-random)") #,title="(A)")
#hh<- hh+ theme(axis.title.x = element_text(face="bold", size=10),title=element_text(face="bold", size=10))
hh<- hh + theme(axis.text = element_text(size=12))
hh<- hh + theme(axis.text.x =element_text(vjust= 0, angle=-90))
hh<- hh + theme(axis.title = element_text(vjust=0.5, size=10))
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8))
hh<- hh + theme(plot.title = element_text(size = 10))
hh<- hh + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
hh<- hh + ggtitle("(B)")
#hh<-hh + geom_text(data = means , aes(label = duration, y = duration + 0.08))
hh


tiff("S1Fig.tiff", height =22.23 , width =19.05, units = "cm", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```

## Figure S2
```{r}
merged_data_stig<-size50[which(merged_data$dir_move==TRUE),]
merged_data_rand<-size50[which(merged_data$dir_move==FALSE),]

mean_prev_stig <- summaryBy(max_prevalence~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_stig, FUN=mean)

mean_dur_stig <- summaryBy(duration~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_stig, FUN=mean)

mean_prev_rand <- summaryBy(max_prevalence~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_rand, FUN=mean)

mean_dur_rand <- summaryBy(duration~n.initial+ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=merged_data_rand, FUN=mean)



# Difference in mean prevalence -------------------------------------------

delta_mean_prev<-mean_prev_rand
delta_mean_prev$max_prevalence.mean.stig<-mean_prev_stig$max_prevalence.mean
delta_mean_prev$diff<-mean_prev_stig$max_prevalence.mean- mean_prev_rand$max_prevalence.mean 

gg<- ggplot(data=delta_mean_prev, aes(y=diff, x=as.factor(rec_rate)))
gg<-gg+ geom_boxplot()+ facet_grid( ~ inf_decay, scales= "free_x", labeller= labeller(
  dir_move = c("FALSE" = "Random", "TRUE"="Stigmergy"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")))
gg<- gg+ labs(x = expression(Recovery~rate~(gamma)), y = "Difference in mean maximum prevalence (stigmergy-random)") #,title="(A)")
#gg<- gg+ theme(axis.title.x = element_text(face="bold", size=10),title=element_text(face="bold", size=10))
gg<- gg + theme(axis.text = element_text(size=12))
gg<- gg + theme(axis.text.x =element_text(vjust= 0, angle=-90))
gg<- gg + theme(axis.title = element_text(vjust=0.5, size=10))
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8))
gg<- gg + theme(plot.title = element_text(size = 10))
gg<- gg + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
gg<- gg + ggtitle("(A)")
#gg<-gg + geom_text(data = means , aes(label = duration, y = duration + 0.08))
gg


delta_mean_dur<-mean_dur_rand
delta_mean_dur$duration.mean.stig<-mean_dur_stig$duration.mean
delta_mean_dur$diff<-mean_dur_stig$duration.mean- mean_dur_rand$duration.mean

hh<- ggplot(data=delta_mean_dur, aes(y=diff, x=as.factor(rec_rate)))
hh<-hh+ geom_boxplot()+ facet_grid( ~ inf_decay, scales= "free_x", labeller= labeller(
  dir_move = c("FALSE" = "Random", "TRUE"="Stigmergy"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")))
hh<- hh+ labs(x = expression(Recovery~rate~(gamma)), y = "Difference in mean duration (stigmergy-random)") #,title="(A)")
#hh<- hh+ theme(axis.title.x = element_text(face="bold", size=10),title=element_text(face="bold", size=10))
hh<- hh + theme(axis.text = element_text(size=12))
hh<- hh + theme(axis.text.x =element_text(vjust= 0, angle=-90))
hh<- hh + theme(axis.title = element_text(vjust=0.5, size=10))
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8))
hh<- hh + theme(plot.title = element_text(size = 10))
hh<- hh + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
hh<- hh + ggtitle("(B)")
#hh<-hh + geom_text(data = means , aes(label = duration, y = duration + 0.08))
hh


tiff("FigS2.tiff", height =22.23 , width =19.05, units = "cm", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```
## Figure 5
Heatmap duration for n.initial=150, dir_move=T, and recovery rate= 0.01

```{r}
lowhigh<-sub_n150_dT_r0.01[which(sub_n150_dT_r0.01$inf_decay!=0.1 & sub_n150_dT_r0.01$scent_decay!=0.1),] #include only low and high pathogen and scent decay rates
sdf <- summaryBy(max_prevalence~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=lowhigh, FUN=mean)
gg <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=max_prevalence.mean))
gg <- gg + geom_tile(color="white", size=0.1)
gg <- gg + scale_fill_viridis(name="Mean\nmaximum\nprevalence")
gg <- gg + coord_equal()
gg <- gg + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
gg<- gg+ labs(x ="Initial pathogen load", y="Initial scent load")
gg<- gg+ theme(axis.title = element_text(size=10))
gg<- gg + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
gg<- gg + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8)) 
gg<- gg + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
gg<- gg+ ggtitle("(A)")
gg

sdf <- summaryBy(duration~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=lowhigh, FUN=mean)
hh <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=duration.mean))
hh <- hh + geom_tile(color="white", size=0.1)
hh <- hh + scale_fill_viridis(name="Mean\nduration")
hh <- hh + coord_equal()
hh <- hh + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
hh<- hh+ labs(x ="Initial pathogen load", y="Initial scent load")
hh<- hh+ theme(axis.title = element_text(size=10))
hh<- hh + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
hh<- hh + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8)) 
hh<- hh + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
hh<- hh + ggtitle("(B)")
hh

tiff("Fig5.tiff", height =22.23 , width =13, units = "cm", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```
## Figure S3
Heatmap duration for n.initial=100, dir_move=T, and recovery rate= 0.01

```{r}
sdf <- summaryBy(max_prevalence~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n100_dT_r0.01, FUN=mean)
gg <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=max_prevalence.mean))
gg <- gg + geom_tile(color="white", size=0.1)
gg <- gg + scale_fill_viridis(name="Mean\nmaximum\nprevalence")
gg <- gg + coord_equal()
gg <- gg + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
gg<- gg+ labs(x ="Initial pathogen load", y="Initial scent load")
gg<- gg+ theme(axis.title = element_text(size=10))
gg<- gg + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
gg<- gg + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8)) 
gg<- gg + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
gg<- gg+ ggtitle("(A)")
gg

sdf <- summaryBy(duration~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n100_dT_r0.01, FUN=mean)
hh <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=duration.mean))
hh <- hh + geom_tile(color="white", size=0.1)
hh <- hh + scale_fill_viridis(name="Mean\nduration")
hh <- hh + coord_equal()
hh <- hh + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
hh<- hh+ labs(x ="Initial pathogen load", y="Initial scent load")
hh<- hh+ theme(axis.title = element_text(size=10))
hh<- hh + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
hh<- hh + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8)) 
hh<- hh + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
hh<- hh + ggtitle("(B)")
hh

tiff("FigS3.tiff", height =22.23 , width =13, units = "cm", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```


## S4 Figure
Heatmap duration for n.initial=50, dir_move=T, and recovery rate= 0.01

```{r}
sdf <- summaryBy(max_prevalence~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n50_dT_r0.01, FUN=mean)
gg <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=max_prevalence.mean))
gg <- gg + geom_tile(color="white", size=0.1)
gg <- gg + scale_fill_viridis(name="Mean\nmaximum\nprevalence")
gg <- gg + coord_equal()
gg <- gg + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
gg<- gg+ labs(x ="Initial pathogen load", y="Initial scent load")
gg<- gg+ theme(axis.title = element_text(size=10))
gg<- gg + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
gg<- gg + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8)) 
gg<- gg + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
gg<- gg+ ggtitle("(A)")
gg

sdf <- summaryBy(duration~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n50_dT_r0.01, FUN=mean)
hh <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=duration.mean))
hh <- hh + geom_tile(color="white", size=0.1)
hh <- hh + scale_fill_viridis(name="Mean\nduration")
hh <- hh + coord_equal()
hh <- hh + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
hh<- hh+ labs(x ="Initial pathogen load", y="Initial scent load")
hh<- hh+ theme(axis.title = element_text(size=10))
hh<- hh + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
hh<- hh + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8)) 
hh<- hh + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
hh<- hh + ggtitle("(B)")
hh

tiff("S4Fig.tiff", height =22.23 , width =13, units = "cm", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```

## Figure S5
Heatmap duration for n.initial=150, dir_move=T, and recovery rate= 0.05

```{r}
sdf <- summaryBy(max_prevalence~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n150_dT_r0.05, FUN=mean)
gg <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=max_prevalence.mean))
gg <- gg + geom_tile(color="white", size=0.1)
gg <- gg + scale_fill_viridis(name="Mean\nmaximum\nprevalence")
gg <- gg + coord_equal()
gg <- gg + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
gg<- gg+ labs(x ="Initial pathogen load", y="Initial scent load")
gg<- gg+ theme(axis.title = element_text(size=10))
gg<- gg + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
gg<- gg + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8)) 
gg<- gg + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
gg<- gg+ ggtitle("(A)")
gg

sdf <- summaryBy(duration~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n150_dT_r0.05, FUN=mean)
hh <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=duration.mean))
hh <- hh + geom_tile(color="white", size=0.1)
hh <- hh + scale_fill_viridis(name="Mean\nduration")
hh <- hh + coord_equal()
hh <- hh + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
hh<- hh+ labs(x ="Initial pathogen load", y="Initial scent load")
hh<- hh+ theme(axis.title = element_text(size=10))
hh<- hh + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
hh<- hh + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8)) 
hh<- hh + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
hh<- hh + ggtitle("(B)")
hh

tiff("S5Fig.tiff", height =22.23 , width =13, units = "cm", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```
## S6 Fig 
```{r}
sdf <- summaryBy(max_prevalence~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n100_dT_r0.05, FUN=mean)
gg <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=max_prevalence.mean))
gg <- gg + geom_tile(color="white", size=0.1)
gg <- gg + scale_fill_viridis(name="Mean\nmaximum\nprevalence")
gg <- gg + coord_equal()
gg <- gg + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
gg<- gg+ labs(x ="Initial pathogen load", y="Initial scent load")
gg<- gg+ theme(axis.title = element_text(size=10))
gg<- gg + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
gg<- gg + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8)) 
gg<- gg + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
gg<- gg+ ggtitle("(A)")
gg

sdf <- summaryBy(duration~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n100_dT_r0.05, FUN=mean)
hh <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=duration.mean))
hh <- hh + geom_tile(color="white", size=0.1)
hh <- hh + scale_fill_viridis(name="Mean\nduration")
hh <- hh + coord_equal()
hh <- hh + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
hh<- hh+ labs(x ="Initial pathogen load", y="Initial scent load")
hh<- hh+ theme(axis.title = element_text(size=10))
hh<- hh + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
hh<- hh + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8)) 
hh<- hh + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
hh<- hh + ggtitle("(B)")
hh

tiff("S6Fig.tiff", height =22.23 , width =13, units = "cm", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```

## Figure S7
Heatmap duration for n.initial=150, dir_move=T, and recovery rate= 0.10
```{r}
sdf <- summaryBy(max_prevalence~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n150_dT_r0.1, FUN=mean)
gg <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=max_prevalence.mean))
gg <- gg + geom_tile(color="white", size=0.1)
gg <- gg + scale_fill_viridis(name="Mean\nmaximum\nprevalence")
gg <- gg + coord_equal()
gg <- gg + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
gg<- gg+ labs(x ="Initial pathogen load", y="Initial scent load")
gg<- gg+ theme(axis.title = element_text(size=10))
gg<- gg + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
gg<- gg + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8)) 
gg<- gg + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
gg<- gg+ ggtitle("(A)")
gg

sdf <- summaryBy(duration~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n150_dT_r0.1, FUN=mean)
hh <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=duration.mean))
hh <- hh + geom_tile(color="white", size=0.1)
hh <- hh + scale_fill_viridis(name="Mean\nduration")
hh <- hh + coord_equal()
hh <- hh + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
hh<- hh+ labs(x ="Initial pathogen load", y="Initial scent load")
hh<- hh+ theme(axis.title = element_text(size=10))
hh<- hh + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
hh<- hh + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8)) 
hh<- hh + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
hh<- hh + ggtitle("(B)")
hh

tiff("S7Fig.tiff", height =22.23 , width =13, units = "cm", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```


## S8 Fig 
```{r}
sdf <- summaryBy(max_prevalence~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n100_dT_r0.1, FUN=mean)
gg <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=max_prevalence.mean))
gg <- gg + geom_tile(color="white", size=0.1)
gg <- gg + scale_fill_viridis(name="Mean\nmaximum\nprevalence")
gg <- gg + coord_equal()
gg <- gg + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
gg<- gg+ labs(x ="Initial pathogen load", y="Initial scent load")
gg<- gg+ theme(axis.title = element_text(size=10))
gg<- gg + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
gg<- gg + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8)) 
gg<- gg + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
gg<- gg+ ggtitle("(A)")
gg

sdf <- summaryBy(duration~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n100_dT_r0.1, FUN=mean)
hh <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=duration.mean))
hh <- hh + geom_tile(color="white", size=0.1)
hh <- hh + scale_fill_viridis(name="Mean\nduration")
hh <- hh + coord_equal()
hh <- hh + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
hh<- hh+ labs(x ="Initial pathogen load", y="Initial scent load")
hh<- hh+ theme(axis.title = element_text(size=10))
hh<- hh + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
hh<- hh + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8)) 
hh<- hh + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
hh<- hh + ggtitle("(B)")
hh

tiff("S8Fig.tiff", height =22.23 , width =13, units = "cm", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```

## S9 Figure
```{r}
sdf <- summaryBy(max_prevalence~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n50_dT_r0.05, FUN=mean)
gg <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=max_prevalence.mean))
gg <- gg + geom_tile(color="white", size=0.1)
gg <- gg + scale_fill_viridis(name="Mean\nmaximum\nprevalence")
gg <- gg + coord_equal()
gg <- gg + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
gg<- gg+ labs(x ="Initial pathogen load", y="Initial scent load")
gg<- gg+ theme(axis.title = element_text(size=10))
gg<- gg + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
gg<- gg + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8)) 
gg<- gg + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
gg<- gg+ ggtitle("(A)")
gg

sdf <- summaryBy(duration~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n50_dT_r0.05, FUN=mean)
hh <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=duration.mean))
hh <- hh + geom_tile(color="white", size=0.1)
hh <- hh + scale_fill_viridis(name="Mean\nduration")
hh <- hh + coord_equal()
hh <- hh + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
hh<- hh+ labs(x ="Initial pathogen load", y="Initial scent load")
hh<- hh+ theme(axis.title = element_text(size=10))
hh<- hh + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
hh<- hh + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8)) 
hh<- hh + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
hh<- hh + ggtitle("(B)")
hh

tiff("S9Fig.tiff", height =22.23 , width =13, units = "cm", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```
## S10 Figure
```{r}
sdf <- summaryBy(max_prevalence~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n50_dT_r0.1, FUN=mean)
gg <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=max_prevalence.mean))
gg <- gg + geom_tile(color="white", size=0.1)
gg <- gg + scale_fill_viridis(name="Mean\nmaximum\nprevalence")
gg <- gg + coord_equal()
gg <- gg + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
gg<- gg+ labs(x ="Initial pathogen load", y="Initial scent load")
gg<- gg+ theme(axis.title = element_text(size=10))
gg<- gg + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
gg<- gg + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
gg<- gg + theme(strip.text = element_text(vjust=0.5, size=8)) 
gg<- gg + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
gg<- gg+ ggtitle("(A)")
gg

sdf <- summaryBy(duration~ rec_rate+scent_load +pathogen_load +scent_decay + inf_decay +dir_move, data=sub_n50_dT_r0.1, FUN=mean)
hh <- ggplot(sdf, aes(x=as.factor(pathogen_load), y=as.factor(scent_load), fill=duration.mean))
hh <- hh + geom_tile(color="white", size=0.1)
hh <- hh + scale_fill_viridis(name="Mean\nduration")
hh <- hh + coord_equal()
hh <- hh + facet_grid(scent_decay~ inf_decay, labeller = labeller(
  scent_decay = c("0.01" = "Slow scent decay", "0.1"="Med. scent decay", "1"= "Fast scent decay"),
  inf_decay = c("0.01" = "Slow pathogen decay", "0.1"="Med. pathogen decay", "1" = "Fast pathogen decay")
))
hh<- hh+ labs(x ="Initial pathogen load", y="Initial scent load")
hh<- hh+ theme(axis.title = element_text(size=10))
hh<- hh + theme(axis.text.x = element_text(angle=90, vjust=0.5, size=10))
hh<- hh + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
hh<- hh + theme(strip.text = element_text(vjust=0.5, size=8)) 
hh<- hh + theme(legend.text = element_text(vjust=0.5, size=10), legend.title=element_text(vjust=0.5, size=10))
hh<- hh + ggtitle("(B)")
hh

tiff("S10Fig.tiff", height =22.23 , width =13, units = "cm", compression = "lzw", res = 600)
multiplot(gg, hh, cols=1)
dev.off()
```



## Figure 6
```{r}
lowhigh<-sub_n150_dT_r0.01[which(sub_n150_dT_r0.01$PL!="medPL" & sub_n150_dT_r0.01$SL!="medSL"),] #include only low and high pathogen and scent decay rates

ii<- ggplot(data=lowhigh, aes(x=as.factor(inf_decay), y=max_prevalence, fill=as.factor(scent_decay)))
# ii<- ii+ geom_boxplot() #+ geom_jitter(alpha=0.5)
# ii<- ii+ stat_summary(fun.y=mean, geom="point", col="blue")
ii <- ii+ geom_boxplot() + facet_grid(scent_load~ pathogen_load, labeller = labeller(
  scent_load = c("0.5" = "Low SL", "1"= "Med SL", "10"= "High SL"),
  pathogen_load = c("0.5" = "Low PL","1" = "Med PL", "10" = "High PL")))
ii<- ii+ labs(x = " ", y = "Maximum prevalence", fill= "Scent\ndecay rate")
ii<- ii+ theme(plot.title = element_text(size=12))
ii<- ii+ theme(axis.title = element_text(size=11))
ii<- ii + theme(axis.text.x = element_text(angle=90, vjust=0.5, hjust=0, size=10))
ii<- ii + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
ii<- ii + theme(strip.text = element_text(vjust=0.5, size=11)) 
ii<- ii + theme(legend.text = element_text(vjust=0.5, size=11), legend.title=element_text(vjust=0.5, size=11))
ii<- ii + geom_vline(xintercept=c(6.5,12.5), linetype="dashed")
ii<- ii + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
ii

jj<- ggplot(data=lowhigh, aes(x=as.factor(inf_decay), y=duration, fill=as.factor(scent_decay)))
# jj<- jj+ geom_boxplot() #+ geom_jitter(alpha=0.5)
# jj<- jj+ stat_summary(fun.y=mean, geom="point", col="blue")
jj <- jj+ geom_boxplot() + facet_grid(scent_load~ pathogen_load, labeller = labeller(
  scent_load = c("0.5" = "Low SL", "1"= "Med SL", "10"= "High SL"),
  pathogen_load = c("0.5" = "Low PL","1" = "Med PL", "10" = "High PL")))
jj<- jj+ labs(x = "Infection decay rate", y = "Duration", fill= "Scent\ndecay rate")
jj<- jj+ theme(plot.title = element_text(size=12))
jj<- jj+ theme(axis.title = element_text(size=11))
jj<- jj + theme(axis.text.x = element_text(angle=90, vjust=0.5, hjust=0, size=10))
jj<- jj + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
jj<- jj + theme(strip.text = element_text(vjust=0.5, size=11)) 
jj<- jj + theme(legend.text = element_text(vjust=0.5, size=11), legend.title=element_text(vjust=0.5, size=11))
jj<- jj + geom_vline(xintercept=c(6.5,12.5), linetype="dashed")
jj<- jj + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
jj

tiff("Fig6.tiff", height =22.23 , width =19.05, units = "cm", compression = "lzw", res = 600)
multiplot(ii, jj, cols=1)
dev.off()

```


## Figure S11
```{r}
ii<- ggplot(data=sub_n100_dT_r0.01, aes(x=as.factor(inf_decay), y=max_prevalence, fill=as.factor(scent_decay)))
# ii<- ii+ geom_boxplot() #+ geom_jitter(alpha=0.5)
# ii<- ii+ stat_summary(fun.y=mean, geom="point", col="blue")
ii <- ii+ geom_boxplot() + facet_grid(scent_load~ pathogen_load, labeller = labeller(
  scent_load = c("0.5" = "Low SL", "1"= "Med SL", "10"= "High SL"),
  pathogen_load = c("0.5" = "Low PL","1" = "Med PL", "10" = "High PL")))
ii<- ii+ labs(x = " ", y = "Maximum prevalence", fill= "Scent\ndecay rate")
ii<- ii+ theme(plot.title = element_text(size=12))
ii<- ii+ theme(axis.title = element_text(size=11))
ii<- ii + theme(axis.text.x = element_text(angle=90, vjust=0.5, hjust=0, size=10))
ii<- ii + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
ii<- ii + theme(strip.text = element_text(vjust=0.5, size=11)) 
ii<- ii + theme(legend.text = element_text(vjust=0.5, size=11), legend.title=element_text(vjust=0.5, size=11))
ii<- ii + geom_vline(xintercept=c(6.5,12.5), linetype="dashed")
ii<- ii + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
ii

jj<- ggplot(data=sub_n100_dT_r0.01, aes(x=as.factor(inf_decay), y=duration, fill=as.factor(scent_decay)))
# jj<- jj+ geom_boxplot() #+ geom_jitter(alpha=0.5)
# jj<- jj+ stat_summary(fun.y=mean, geom="point", col="blue")
jj <- jj+ geom_boxplot() + facet_grid(scent_load~ pathogen_load, labeller = labeller(
  scent_load = c("0.5" = "Low SL", "1"= "Med SL", "10"= "High SL"),
  pathogen_load = c("0.5" = "Low PL","1" = "Med PL", "10" = "High PL")))
jj<- jj+ labs(x = "Infection decay rate", y = "Duration", fill= "Scent\ndecay rate")
jj<- jj+ theme(plot.title = element_text(size=12))
jj<- jj+ theme(axis.title = element_text(size=11))
jj<- jj + theme(axis.text.x = element_text(angle=90, vjust=0.5, hjust=0, size=10))
jj<- jj + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
jj<- jj + theme(strip.text = element_text(vjust=0.5, size=11)) 
jj<- jj + theme(legend.text = element_text(vjust=0.5, size=11), legend.title=element_text(vjust=0.5, size=11))
jj<- jj + geom_vline(xintercept=c(6.5,12.5), linetype="dashed")
jj<- jj + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
jj

tiff("S11Fig.tiff", height =22.23 , width =19.05, units = "cm", compression = "lzw", res = 600)
multiplot(ii, jj, cols=1)
dev.off()

```


## Figure S12
```{r}
ii<- ggplot(data=sub_n50_dT_r0.01, aes(x=as.factor(inf_decay), y=max_prevalence, fill=as.factor(scent_decay)))
# ii<- ii+ geom_boxplot() #+ geom_jitter(alpha=0.5)
# ii<- ii+ stat_summary(fun.y=mean, geom="point", col="blue")
ii <- ii+ geom_boxplot() + facet_grid(scent_load~ pathogen_load, labeller = labeller(
  scent_load = c("0.5" = "Low SL", "1"= "Med SL", "10"= "High SL"),
  pathogen_load = c("0.5" = "Low PL","1" = "Med PL", "10" = "High PL")))
ii<- ii+ labs(x = " ", y = "Maximum prevalence", fill= "Scent\ndecay rate")
ii<- ii+ theme(plot.title = element_text(size=12))
ii<- ii+ theme(axis.title = element_text(size=11))
ii<- ii + theme(axis.text.x = element_text(angle=90, vjust=0.5, hjust=0, size=10))
ii<- ii + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
ii<- ii + theme(strip.text = element_text(vjust=0.5, size=11)) 
ii<- ii + theme(legend.text = element_text(vjust=0.5, size=11), legend.title=element_text(vjust=0.5, size=11))
ii<- ii + geom_vline(xintercept=c(6.5,12.5), linetype="dashed")
ii<- ii + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
ii

jj<- ggplot(data=sub_n50_dT_r0.01, aes(x=as.factor(inf_decay), y=duration, fill=as.factor(scent_decay)))
# jj<- jj+ geom_boxplot() #+ geom_jitter(alpha=0.5)
# jj<- jj+ stat_summary(fun.y=mean, geom="point", col="blue")
jj <- jj+ geom_boxplot() + facet_grid(scent_load~ pathogen_load, labeller = labeller(
  scent_load = c("0.5" = "Low SL", "1"= "Med SL", "10"= "High SL"),
  pathogen_load = c("0.5" = "Low PL","1" = "Med PL", "10" = "High PL")))
jj<- jj+ labs(x = "Infection decay rate", y = "Duration", fill= "Scent\ndecay rate")
jj<- jj+ theme(plot.title = element_text(size=12))
jj<- jj+ theme(axis.title = element_text(size=11))
jj<- jj + theme(axis.text.x = element_text(angle=90, vjust=0.5, hjust=0, size=10))
jj<- jj + theme(axis.text.y = element_text(vjust=0.5, size=10)) 
jj<- jj + theme(strip.text = element_text(vjust=0.5, size=11)) 
jj<- jj + theme(legend.text = element_text(vjust=0.5, size=11), legend.title=element_text(vjust=0.5, size=11))
jj<- jj + geom_vline(xintercept=c(6.5,12.5), linetype="dashed")
jj<- jj + theme(plot.margin=unit(c(0.1,0.1,0,0.1), "cm"))
jj

tiff("S12Fig.tiff", height =22.23 , width =19.05, units = "cm", compression = "lzw", res = 600)
multiplot(ii, jj, cols=1)
dev.off()

```